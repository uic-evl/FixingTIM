var App=App||{},pvUtils=function(a){var d=null;return{zoomToSelections:function(){var b=[];a.pvViewer.forEach(function(a){void 0!==a.selection&&b.push(a.selection())});a.pvViewer.fitTo(b)},linkInteractions:function(){var a=this,c=this.pvViewer.__proto__.requestRedraw,e=a.pvViewer._cam.__proto__.zoom;this.pvViewer.__proto__.requestRedraw=function(){if(this._redrawRequested){var b=this._cam._rotation;a.axis3D.setRotation(Math.atan2(b[9],b[10]),Math.atan2(-b[8],Math.sqrt(b[9]*b[9]+b[10]*b[10])),Math.atan2(b[4],
b[0]));a.modelRotated.notify({rotation:b})}return c.apply(this,arguments)};a.pvViewer._cam.__proto__.zoom=function(){a.modelZoomed.notify({zoom:this._zoom});return e.apply(this,arguments)}},setColorForAtom:function(a,c,e){var b=a.structure().createEmptyView();b.addAtom(c);a.colorBy(pv.color.uniform(e),b)},selectResidue:function(b,c){a.rem=!1;c._atoms.forEach(function(c){a.rem=b.removeAtom(c,!0)});a.rem||c._atoms.forEach(function(a){b.addAtom(a)});return b},mouseMoveEvent:function(b){if(b){var c=a.pvViewer.boundingClientRect();
a.picked=a.pvViewer.pick({x:b.clientX-c.left,y:b.clientY-c.top});if(null!==d&&null!==a.picked&&a.picked.target()===d.atom)return;null!==d&&a.setColorForAtom(d.node,d.atom,d.color);null!==a.picked?(b=a.picked.target(),a.staticLabel.innerHTML=b._residue._chain._name+"."+b._residue._name+"."+(b._residue._index+1),c=[0,0,0,0],a.picked.node().getColorForAtom(b,c),d={atom:b,color:c,node:a.picked.node()},a.setColorForAtom(a.picked.node(),b,"#984ea3")):(a.staticLabel.innerHTML="&nbsp;",d=null)}a.pvViewer.requestRedraw()},
mouseClickEvent:function(b,c){a.picked=b;if(null!==a.picked&&null!==a.picked.target()&&void 0!==a.picked.node().structure){b=c.shiftKey;c=b?a.picked.node().selection():a.picked.node().structure().createEmptyView();var d=a.picked.target()._residue;c=a.selectResidue(c,d);a.rem?a.residueDeselected.notify({selection:c,residue:d}):a.residueSelected.notify({selection:c,residue:d,replace:!b})}}}};
